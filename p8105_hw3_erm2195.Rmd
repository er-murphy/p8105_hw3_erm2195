---
title: "P8105 Homework 3"
output: github_document
date: "2023-10-10"
---

This homework includes figures; the readability of embedded plots (e.g. font sizes, axis labels, titles) will be assessed!

# Library Setup
Loading the `tidyverse` and `p8105 datasets` libraries for later use. Also establishing some document-wide theme and visualization output settings.

```{r load_libraries, include = FALSE}
library(tidyverse)
library(p8105.datasets)

knitr::opts_chunk$set(
	echo = TRUE,
	warning = FALSE,
	fig.width = 8, 
  fig.height = 6,
  out.width = "90%"
)

theme_set(theme_minimal() + theme(legend.position = "bottom"))

options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)

scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d

```

# Problem 1

## Read in Dataset
```{r}
data("instacart")

instacart = as_tibble(instacart)

```

## Describing the `instacart` dataset
The `instacart` dataset has `r nrow(instacart)` observations and `r ncol(instacart)` variables. It contains information about the items in instacart orders from `r instacart |> select(user_id) |> distinct() |> count()` different individuals in 2017. The dataset includes variables with details about the user placing the order, the date and time of the order itself, and specifics on the items being ordered, including their name and physical and department location in the store. In total, there are `r instacart |> select(product_id) |> distinct() |> count()` separate products included in the dataset. On average, each order was placed `r instacart |> pull(days_since_prior_order) |> mean() |> round()` days after that individual's prior order. `r 100 *(instacart |> pull(reordered) |> mean() |> round(digits = 4))`% of products were reordered.

## Number of Aisles and Most Commonly Used Aisles
To see how many aisles there are, and which aisles have the most items ordered from them, we can create a table.
Below is a table summarizing the number of items ordered from aisle. In total, there are 134 aisles, with fresh vegetables and fresh fruits holding the most items ordered by far.

```{r}
instacart |> 
  count(aisle) |> 
  arrange(desc(n))
```

In total, there are `r instacart |> count(aisle) |> arrange(desc(n)) |> nrow()` aisles, and the two most commonly ordered-from aisles are `r instacart |> count(aisle) |> arrange(desc(n)) |> slice(1) |> pull(aisle)` and `r instacart |> count(aisle) |> arrange(desc(n)) |> slice(2) |> pull(aisle)`.

## Plotting Items Ordered from Each Aisle

Next is a plot that shows the number of items ordered in each aisle. Here, aisles are ordered by ascending number of items.

```{r}
instacart |> 
  count(aisle) |> 
  filter(n > 10000) |> 
  mutate(aisle = fct_reorder(aisle, n)) |> 
  ggplot(aes(x = aisle, y = n)) + 
  geom_point() + 
  labs(title = "Number of items ordered in each aisle") +
  theme(axis.text.x = element_text(angle = 60, hjust = 1))

```

Make a plot that shows the number of items ordered in each aisle, limiting this to aisles with more than 10000 items ordered. Arrange aisles sensibly, and organize your plot so others can read it.
Make a table showing the three most popular items in each of the aisles “baking ingredients”, “dog food care”, and “packaged vegetables fruits”. Include the number of times each item is ordered in your table.
Make a table showing the mean hour of the day at which Pink Lady Apples and Coffee Ice Cream are ordered on each day of the week; format this table for human readers (i.e. produce a 2 x 7 table).

